<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Nataliya's Wool Paintings</title>
  <style>
    /* Basic layout */
    body { font-family: Arial, sans-serif; margin:0; padding:20px; background:#f4f4f4; color:#222; }
    nav { position:absolute; top:20px; left:20px; display:flex; flex-direction:column; gap:10px; }
    .nav-button { padding:10px 20px; background:#333; color:#fff; border-radius:6px; border:none; cursor:pointer; text-decoration:none; font-size:16px; }
    .nav-button:hover { background:#555; }
    .nav-button.inactive { opacity:.5; cursor:default; pointer-events:none; }
    h1 { text-align:center; margin-top:6px; color:#333; }

    /* Home & gallery containers */
    .home-content, .gallery-content { display:none; gap:20px; max-width:1200px; margin:0 auto; padding:20px; }
    .home-content { display:flex; align-items:flex-start; justify-content:center; }
    .artist-image { width:300px; height:400px; object-fit:cover; border-radius:10px; background:#ccc; }
    .description { flex:1; text-align:left; font-size:16px; color:#333; }
    @media (max-width:600px) {
      .home-content { flex-direction:column; align-items:center; }
      .artist-image { width:200px; height:267px; }
      .description { text-align:center; }
    }

    /* Gallery grid */
    .gallery-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px; width:100%; align-items:start; }
    .gallery-item { background:#fff; padding:6px; border-radius:8px; box-shadow: 0 1px 4px rgba(0,0,0,0.06); cursor:pointer; }
    .gallery-item img { width:100%; height:200px; object-fit:cover; border-radius:6px; display:block; }

    /* Lightbox */
    .lightbox { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.8); z-index:1000; }
    .lightbox.active { display:flex; }
    .lightbox img { max-width:90%; max-height:80%; border-radius:8px; box-shadow:0 6px 30px rgba(0,0,0,0.6); }
    .lightbox .nav-arrow { position:absolute; top:50%; transform:translateY(-50%); color:#fff; font-size:40px; padding:12px; cursor:pointer; user-select:none; }
    .lightbox .prev { left:20px; }
    .lightbox .next { right:20px; }
    .lightbox .close { position:absolute; top:20px; right:20px; color:#fff; font-size:28px; cursor:pointer; }

    /* small note text */
    .note { text-align:center; color:#666; margin-top:10px; font-size:14px; }
  </style>
</head>
<body>
  <nav>
    <button id="homeBtn" class="nav-button inactive">Home</button>
    <button id="galleryBtn" class="nav-button">Gallery</button>
  </nav>

  <h1>Nataliya's Wool Paintings</h1>

  <!-- HOME -->
  <section id="home" class="home-content" aria-labelledby="homeHeading">
    <img src="/WoolPaintings/gallery/artist-placeholder.jpg" alt="Artist Portrait" class="artist-image" onerror="this.style.opacity=.5;">
    <div class="description">
      <h2 id="homeHeading">About the artist</h2>
      <p>Welcome to Nataliya's Wool Paintings! This is a placeholder for the artist's description. Add details about your artistic journey, inspiration, and techniques here.</p>
      <p>Explore the gallery to view a collection of unique wool paintings, each crafted with care and creativity.</p>
    </div>
  </section>

  <!-- GALLERY -->
  <section id="gallery" class="gallery-content" aria-labelledby="galleryHeading">
    <h2 id="galleryHeading" style="width:100%; text-align:left; margin-bottom:8px;">Gallery</h2>
    <div id="galleryGrid" class="gallery-grid" aria-live="polite"></div>
    <p class="note" id="galleryNote">Loading imagesâ€¦</p>
  </section>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <span class="close" id="lbClose" title="Close" aria-hidden="false">&#x2715;</span>
    <span class="nav-arrow prev" id="lbPrev" title="Previous">&#10094;</span>
    <img id="lbImage" alt="Full view">
    <span class="nav-arrow next" id="lbNext" title="Next">&#10095;</span>
  </div>

  <script>
    /* -------------------
       Navigation & view (with legacy-home guard)
       ------------------- */
    const homeBtn = document.getElementById('homeBtn');
    const galleryBtn = document.getElementById('galleryBtn');
    const homeSection = document.getElementById('home');
    const gallerySection = document.getElementById('gallery');

    function showHome(push = true) {
      homeSection.style.display = 'flex';
      gallerySection.style.display = 'none';
      homeBtn.classList.add('inactive');
      galleryBtn.classList.remove('inactive');
      if (push) history.pushState(null, '', '/WoolPaintings/');
    }
    function showGallery(push = true) {
      homeSection.style.display = 'none';
      gallerySection.style.display = 'block';
      homeBtn.classList.remove('inactive');
      galleryBtn.classList.add('inactive');
      if (push) history.pushState(null, '', '/WoolPaintings/gallery');
    }
    homeBtn.addEventListener('click', () => showHome(true));
    galleryBtn.addEventListener('click', () => { showGallery(true); loadGalleryIfNeeded(); });

    // If user somehow navigated to /WoolPaintings/home.html, normalize it to root
    function normalizeHomePathOnLoad() {
      const path = window.location.pathname;
      if (path.endsWith('/home.html') || path.endsWith('/home') || path.includes('/home.html')) {
        // replace browser address without creating a new history entry
        history.replaceState(null, '', '/WoolPaintings/');
        // show home view (don't push a new state)
        showHome(false);
      }
    }

    // Intercept any <a> clicks that point to a legacy home.html and route to showHome()
    function handleLegacyHomeLinks() {
      document.addEventListener('click', (e) => {
        const a = e.target.closest && e.target.closest('a');
        if (!a) return;
        try {
          const href = a.getAttribute('href') || '';
          // Normalize relative and absolute cases that end with home.html
          if (href.endsWith('home.html') || href.endsWith('/home') || href === '/WoolPaintings/home.html') {
            e.preventDefault();
            showHome(true);
          }
        } catch (err) {
          // noop
        }
      }, { capture: true });
    }

    // On page load / back-button navigation
    window.addEventListener('popstate', () => {
      if (location.pathname.endsWith('/gallery') || location.pathname.includes('/gallery')) showGallery(false);
      else showHome(false);
    });

    // normalize legacy paths and set up link interception
    normalizeHomePathOnLoad();
    handleLegacyHomeLinks();

    // initial view detect (after normalization)
    if (window.location.pathname.includes('/gallery')) showGallery(false);
    else showHome(false);

    /* -------------------
       Gallery loader
       ------------------- */
    const galleryGrid = document.getElementById('galleryGrid');
    const galleryNote = document.getElementById('galleryNote');

    // Optionally, you can explicitly list filenames here to guarantee order:
    // const EXPLICIT_IMAGES = ['wool1.jpg','wool2.jpg','closeup.jpg']; // <- uncomment & edit if you have names
    const EXPLICIT_IMAGES = []; // empty by default

    // Patterns we will attempt (will skip files that 404)
    const patterns = [
      'artist-placeholder.jpg',
      // common numbered prefixes
      { base: 'img', start: 1, end: 30, ext: '.jpg' },
      { base: 'image', start: 1, end: 30, ext: '.jpg' },
      { base: 'painting', start: 1, end: 30, ext: '.jpg' },
      { base: 'photo', start: 1, end: 30, ext: '.jpg' },
      { base: 'IMG_', start: 1, end: 30, ext: '.jpg', pad: 4 }, // IMG_0001.jpg
      { base: 'DSC', start: 1, end: 30, ext: '.jpg' }
    ];

    // Build a candidate list of filenames to try
    function buildCandidates() {
      const list = [];
      for (const p of patterns) {
        if (typeof p === 'string') { list.push(p); continue; }
        for (let i = p.start; i <= p.end; i++) {
          let num = String(i);
          if (p.pad) num = num.padStart(p.pad, '0');
          list.push(`${p.base}${num}${p.ext}`);
        }
      }
      // append explicit images at front if provided (so they display first)
      return [...EXPLICIT_IMAGES, ...list];
    }

    // Attempts to load an image and resolves true if it exists
    function testImageExists(url) {
      return new Promise(resolve => {
        const img = new Image();
        img.onload = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = url + '?_=' + encodeURIComponent(Date.now()); // cache-bust
      });
    }

    let galleryImages = []; // array of {src, alt}

    async function loadGalleryIfNeeded() {
      if (galleryGrid.dataset.loaded === 'true') return;
      galleryNote.textContent = 'Scanning gallery folder for images...';
      const candidates = buildCandidates();
      const basePath = '/WoolPaintings/gallery/';
      const found = [];

      // Try explicit list first for quick results
      for (const name of EXPLICIT_IMAGES) {
        const url = basePath + name;
        if (await testImageExists(url)) found.push(url);
      }

      // Then probe candidates until we've found a decent amount or exhausted
      for (const name of candidates) {
        if (found.length >= 60) break; // safety cap
        // skip duplicates (e.g. explicit images)
        if (EXPLICIT_IMAGES.includes(name)) continue;
        const url = basePath + name;
        if (await testImageExists(url)) {
          found.push(url);
        }
      }

      if (found.length === 0) {
        galleryNote.textContent = 'No gallery images found. If your images use different filenames, paste them into EXPLICIT_IMAGES at top of the script.';
        galleryGrid.innerHTML = '';
        galleryGrid.dataset.loaded = 'true';
        return;
      }

      galleryNote.textContent = `${found.length} image(s) found`;
      galleryImages = found.map((s,i)=>({src:s, alt:`Wool painting ${i+1}`}));
      renderGalleryGrid();
      galleryGrid.dataset.loaded = 'true';
    }

    function renderGalleryGrid() {
      galleryGrid.innerHTML = '';
      galleryImages.forEach((imgObj, idx) => {
        const item = document.createElement('div');
        item.className = 'gallery-item';
        const img = document.createElement('img');
        img.src = imgObj.src;
        img.alt = imgObj.alt;
        img.loading = 'lazy';
        img.dataset.index = idx;
        item.appendChild(img);
        item.addEventListener('click', () => openLightbox(idx));
        galleryGrid.appendChild(item);
      });
    }

    /* -------------------
       Lightbox (full view + arrows)
       ------------------- */
    const lb = document.getElementById('lightbox');
    const lbImage = document.getElementById('lbImage');
    const lbClose = document.getElementById('lbClose');
    const lbPrev = document.getElementById('lbPrev');
    const lbNext = document.getElementById('lbNext');
    let currentIndex = 0;

    function openLightbox(index) {
      if (!galleryImages.length) return;
      currentIndex = index;
      lbImage.src = galleryImages[currentIndex].src;
      lbImage.alt = galleryImages[currentIndex].alt || '';
      lb.classList.add('active');
      lb.setAttribute('aria-hidden','false');
    }
    function closeLightbox() {
      lb.classList.remove('active');
      lb.setAttribute('aria-hidden','true');
      lbImage.src = '';
    }
    function showPrev() {
      if (!galleryImages.length) return;
      currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
      lbImage.src = galleryImages[currentIndex].src;
    }
    function showNext() {
      if (!galleryImages.length) return;
      currentIndex = (currentIndex + 1) % galleryImages.length;
      lbImage.src = galleryImages[currentIndex].src;
    }

    // events
    lbClose.addEventListener('click', closeLightbox);
    lbPrev.addEventListener('click', showPrev);
    lbNext.addEventListener('click', showNext);

    // click outside image closes
    lb.addEventListener('click', (e) => {
      if (e.target === lb) closeLightbox();
    });

    // keyboard
    window.addEventListener('keydown', (e) => {
      if (!lb.classList.contains('active')) return;
      if (e.key === 'ArrowLeft') showPrev();
      if (e.key === 'ArrowRight') showNext();
      if (e === 'Escape' || e.key === 'Escape') closeLightbox();
    });

    // ensure gallery loads if the page was opened on gallery route
    if (window.location.pathname.includes('/gallery')) {
      loadGalleryIfNeeded();
    }

    // small convenience: if you know the exact filenames for your images,
    // replace EXPLICIT_IMAGES array near the top with those filenames (e.g. ['wool1.jpg','wool2.jpg']).
    // That guarantees order and avoids probing delays.
  </script>
</body>
</html>
